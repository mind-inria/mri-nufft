
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Simple UNet model. &#8212; MRI-nufft Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/autoexamples/GPU/example_fastMRI_UNet';</script>
    <link rel="icon" href="../../../_static/mri-nufft-icon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Operators Examples" href="../operators/index.html" />
    <link rel="prev" title="Reconstruction with conjugate gradient" href="example_cg.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mri-nufft.png" class="logo__image only-light" alt="MRI-nufft Documentation - Home"/>
    <script>document.write(`<img src="../../../_static/mri-nufft.png" class="logo__image only-dark" alt="MRI-nufft Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    MRI-NUFFT
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>

<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">GPU Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="example_density.html">Density Compensation Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="example_3d_trajectory_display.html">Gridded trajectory display</a></li>
<li class="toctree-l3"><a class="reference internal" href="example_learn_samples.html">Learn Sampling pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="example_learn_samples_multicoil.html">Learn Sampling pattern for multi-coil MRI</a></li>
<li class="toctree-l3"><a class="reference internal" href="example_learn_straight_line_readouts.html">Learn Straight line readout pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="example_cg.html">Reconstruction with conjugate gradient</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Simple UNet model.</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../operators/index.html">Operators Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../operators/example_readme.html">Minimal example script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operators/example_offresonance.html">Off-resonance corrected NUFFT operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operators/example_stacked.html">Stacked NUFFT operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operators/example_subspace.html">Subspace NUFFT Operator</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../trajectories/index.html">Trajectories Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_2D_trajectories.html">2D Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_3D_trajectories.html">3D Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_gif_2D.html">Animated 2D trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_gif_3D.html">Animated 3D trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_learn_samples_multires.html">Learning sampling pattern with decimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_sampling_densities.html">Sampling densities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_display_config.html">Trajectory display configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajectories/example_trajectory_tools.html">Trajectory tools</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explanations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../nufft.html">The NUFFT Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectory_gradspec.html">The trajectory binary file specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mrinufft_convention.html">MRI-NUFFT Interfaces Convention</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.operators</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.autodiff.html"><code class="docutils literal notranslate"><span class="pre">operators.autodiff</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.autodiff.MRINufftAutoGrad.html">MRINufftAutoGrad</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.base.html"><code class="docutils literal notranslate"><span class="pre">operators.base</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.base.check_backend.html">check_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.base.get_operator.html">get_operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.base.list_backends.html">list_backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.base.FourierOperatorBase.html">FourierOperatorBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.base.FourierOperatorCPU.html">FourierOperatorCPU</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.html"><code class="docutils literal notranslate"><span class="pre">operators.interfaces</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.bart.html"><code class="docutils literal notranslate"><span class="pre">interfaces.bart</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.bart.MRIBartNUFFT.html">MRIBartNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.bart.RawBartNUFFT.html">RawBartNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.cufinufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.cufinufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.cufinufft.MRICufiNUFFT.html">MRICufiNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.cufinufft.RawCufinufftPlan.html">RawCufinufftPlan</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.finufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.finufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.finufft.MRIfinufft.html">MRIfinufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.finufft.RawFinufftPlan.html">RawFinufftPlan</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.gpunufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.gpunufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.gpunufft.make_pinned_smaps.html">make_pinned_smaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.gpunufft.MRIGpuNUFFT.html">MRIGpuNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.gpunufft.RawGpuNUFFT.html">RawGpuNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nfft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.nfft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nfft.get_fourier_matrix.html">get_fourier_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nfft.MRInfft.html">MRInfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nfft.RawPyNFFT3.html">RawPyNFFT3</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nudft_numpy.html"><code class="docutils literal notranslate"><span class="pre">interfaces.nudft_numpy</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nudft_numpy.get_fourier_matrix.html">get_fourier_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nudft_numpy.get_implicit_matrix.html">get_implicit_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nudft_numpy.implicit_type1_ndft.html">implicit_type1_ndft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nudft_numpy.implicit_type2_ndft.html">implicit_type2_ndft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nudft_numpy.MRInumpy.html">MRInumpy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.nudft_numpy.RawNDFT.html">RawNDFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.html"><code class="docutils literal notranslate"><span class="pre">interfaces.pynufft_cpu</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.MRIPynufft.html">MRIPynufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.pynufft_cpu.RawPyNUFFT.html">RawPyNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.sigpy.html"><code class="docutils literal notranslate"><span class="pre">interfaces.sigpy</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.sigpy.MRISigpyNUFFT.html">MRISigpyNUFFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.sigpy.RawSigpyNUFFT.html">RawSigpyNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.tfnufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.tfnufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.tfnufft.MRITensorflowNUFFT.html">MRITensorflowNUFFT</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.torchkbnufft.html"><code class="docutils literal notranslate"><span class="pre">interfaces.torchkbnufft</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.torchkbnufft.MRITorchKbNufft.html">MRITorchKbNufft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.torchkbnufft.TorchKbNUFFTcpu.html">TorchKbNUFFTcpu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.torchkbnufft.TorchKbNUFFTgpu.html">TorchKbNUFFTgpu</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.utils.html"><code class="docutils literal notranslate"><span class="pre">interfaces.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.utils.gpu_utils.html"><code class="docutils literal notranslate"><span class="pre">utils.gpu_utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.operators.interfaces.utils.utils.html"><code class="docutils literal notranslate"><span class="pre">utils.utils</span></code></a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.off_resonance.html"><code class="docutils literal notranslate"><span class="pre">operators.off_resonance</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.off_resonance.get_interpolators_from_fieldmap.html">get_interpolators_from_fieldmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.off_resonance.MRIFourierCorrected.html">MRIFourierCorrected</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.stacked.html"><code class="docutils literal notranslate"><span class="pre">operators.stacked</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.stacked.stacked2traj3d.html">stacked2traj3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.stacked.traj3d2stacked.html">traj3d2stacked</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.stacked.MRIStackedNUFFT.html">MRIStackedNUFFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.stacked.MRIStackedNUFFTGPU.html">MRIStackedNUFFTGPU</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.operators.subspace.html"><code class="docutils literal notranslate"><span class="pre">operators.subspace</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.operators.subspace.MRISubspace.html">MRISubspace</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.trajectories</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display.html"><code class="docutils literal notranslate"><span class="pre">trajectories.display</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display.display_2D_trajectory.html">display_2D_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display.display_3D_trajectory.html">display_3D_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display.display_gradients.html">display_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display.display_gradients_simply.html">display_gradients_simply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display.displayConfig.html">displayConfig</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display3D.html"><code class="docutils literal notranslate"><span class="pre">trajectories.display3D</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.display3D.get_gridded_trajectory.html">get_gridded_trajectory</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.gradients.html"><code class="docutils literal notranslate"><span class="pre">trajectories.gradients</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.gradients.patch_center_anomaly.html">patch_center_anomaly</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.html"><code class="docutils literal notranslate"><span class="pre">trajectories.inits</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.eccentric.html"><code class="docutils literal notranslate"><span class="pre">inits.eccentric</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.eccentric.initialize_2D_eccentric.html">initialize_2D_eccentric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.eccentric.initialize_3D_eccentric.html">initialize_3D_eccentric</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.random_walk.html"><code class="docutils literal notranslate"><span class="pre">inits.random_walk</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.random_walk.initialize_2D_random_walk.html">initialize_2D_random_walk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.random_walk.initialize_3D_random_walk.html">initialize_3D_random_walk</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.travelling_salesman.html"><code class="docutils literal notranslate"><span class="pre">inits.travelling_salesman</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.travelling_salesman.initialize_2D_travelling_salesman.html">initialize_2D_travelling_salesman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.inits.travelling_salesman.initialize_3D_travelling_salesman.html">initialize_3D_travelling_salesman</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.html"><code class="docutils literal notranslate"><span class="pre">trajectories.maths</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.fibonacci.html"><code class="docutils literal notranslate"><span class="pre">maths.fibonacci</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.fibonacci.generate_fibonacci_circle.html">generate_fibonacci_circle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.fibonacci.generate_fibonacci_lattice.html">generate_fibonacci_lattice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.fibonacci.generate_fibonacci_sphere.html">generate_fibonacci_sphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.fibonacci.get_closest_fibonacci_number.html">get_closest_fibonacci_number</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.fibonacci.is_from_fibonacci_sequence.html">is_from_fibonacci_sequence</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.primes.html"><code class="docutils literal notranslate"><span class="pre">maths.primes</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.primes.compute_coprime_factors.html">compute_coprime_factors</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.rotations.html"><code class="docutils literal notranslate"><span class="pre">maths.rotations</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.rotations.R2D.html">R2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.rotations.Ra.html">Ra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.rotations.Rv.html">Rv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.rotations.Rx.html">Rx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.rotations.Ry.html">Ry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.rotations.Rz.html">Rz</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.tsp_solver.html"><code class="docutils literal notranslate"><span class="pre">maths.tsp_solver</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.maths.tsp_solver.solve_tsp_with_2opt.html">solve_tsp_with_2opt</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.sampling.html"><code class="docutils literal notranslate"><span class="pre">trajectories.sampling</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.sampling.create_chauffert_density.html">create_chauffert_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.sampling.create_cutoff_decay_density.html">create_cutoff_decay_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.sampling.create_energy_density.html">create_energy_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.sampling.create_fast_chauffert_density.html">create_fast_chauffert_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.sampling.create_polynomial_density.html">create_polynomial_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.sampling.sample_from_density.html">sample_from_density</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.html"><code class="docutils literal notranslate"><span class="pre">trajectories.tools</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.conify.html">conify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.duplicate_along_axes.html">duplicate_along_axes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.epify.html">epify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.get_gradient_amplitudes_to_travel_for_set_time.html">get_gradient_amplitudes_to_travel_for_set_time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.get_gradient_times_to_travel.html">get_gradient_times_to_travel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.get_random_loc_1d.html">get_random_loc_1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.oversample.html">oversample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.precess.html">precess</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.prewind.html">prewind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.radialize_center.html">radialize_center</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.rewind.html">rewind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.rotate.html">rotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.shellify.html">shellify</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.stack.html">stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.stack_random.html">stack_random</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.stack_spherically.html">stack_spherically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.tools.unepify.html">unepify</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.html"><code class="docutils literal notranslate"><span class="pre">trajectories.trajectory2D</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_cones.html">initialize_2D_cones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_fibonacci_spiral.html">initialize_2D_fibonacci_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_lissajous.html">initialize_2D_lissajous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_polar_lissajous.html">initialize_2D_polar_lissajous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_propeller.html">initialize_2D_propeller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_radial.html">initialize_2D_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_rings.html">initialize_2D_rings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_rosette.html">initialize_2D_rosette</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_sinusoide.html">initialize_2D_sinusoide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_spiral.html">initialize_2D_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory2D.initialize_2D_waves.html">initialize_2D_waves</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.html"><code class="docutils literal notranslate"><span class="pre">trajectories.trajectory3D</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_annular_shells.html">initialize_3D_annular_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_cones.html">initialize_3D_cones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_floret.html">initialize_3D_floret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_golden_means_radial.html">initialize_3D_golden_means_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_helical_shells.html">initialize_3D_helical_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_park_radial.html">initialize_3D_park_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_phyllotaxis_radial.html">initialize_3D_phyllotaxis_radial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_repi.html">initialize_3D_repi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_seiffert_shells.html">initialize_3D_seiffert_shells</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_seiffert_spiral.html">initialize_3D_seiffert_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_turbine.html">initialize_3D_turbine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_wave_caipi.html">initialize_3D_wave_caipi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.trajectory3D.initialize_3D_wong_radial.html">initialize_3D_wong_radial</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.html"><code class="docutils literal notranslate"><span class="pre">trajectories.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.check_hardware_constraints.html">check_hardware_constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.compute_gradients_and_slew_rates.html">compute_gradients_and_slew_rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.convert_gradients_to_slew_rates.html">convert_gradients_to_slew_rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.convert_gradients_to_trajectory.html">convert_gradients_to_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.convert_slew_rates_to_gradients.html">convert_slew_rates_to_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.convert_trajectory_to_gradients.html">convert_trajectory_to_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.initialize_algebraic_spiral.html">initialize_algebraic_spiral</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.initialize_shape_norm.html">initialize_shape_norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.initialize_tilt.html">initialize_tilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.normalize_trajectory.html">normalize_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.unnormalize_trajectory.html">unnormalize_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.Acquisition.html">Acquisition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.CaseInsensitiveEnumMeta.html">CaseInsensitiveEnumMeta</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.FloatEnum.html">FloatEnum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.Gammas.html">Gammas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.Hardware.html">Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.NormShapes.html">NormShapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.Packings.html">Packings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.SI.html">SI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.SIEMENS.html">SIEMENS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.Spirals.html">Spirals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.StrEnum.html">StrEnum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.Tilts.html">Tilts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.VDSorder.html">VDSorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.trajectories.utils.VDSpdf.html">VDSpdf</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.density.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.density</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.density.geometry_based.html"><code class="docutils literal notranslate"><span class="pre">density.geometry_based</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.density.geometry_based.cell_count.html">cell_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.density.geometry_based.voronoi.html">voronoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.density.geometry_based.voronoi_unique.html">voronoi_unique</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.density.nufft_based.html"><code class="docutils literal notranslate"><span class="pre">density.nufft_based</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.density.nufft_based.pipe.html">pipe</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.density.utils.html"><code class="docutils literal notranslate"><span class="pre">density.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.density.utils.flat_traj.html">flat_traj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.density.utils.get_density.html">get_density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.density.utils.normalize_weights.html">normalize_weights</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.io.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.io</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.io.cfl.html"><code class="docutils literal notranslate"><span class="pre">io.cfl</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.cfl.cfl2traj.html">cfl2traj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.cfl.traj2cfl.html">traj2cfl</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.io.nsp.html"><code class="docutils literal notranslate"><span class="pre">io.nsp</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.nsp.read_arbgrad_rawdat.html">read_arbgrad_rawdat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.nsp.read_trajectory.html">read_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.nsp.write_gradients.html">write_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.nsp.write_trajectory.html">write_trajectory</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.io.siemens.html"><code class="docutils literal notranslate"><span class="pre">io.siemens</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.siemens.read_siemens_rawdat.html">read_siemens_rawdat</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.io.utils.html"><code class="docutils literal notranslate"><span class="pre">io.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.utils.add_phase_to_kspace_with_shifts.html">add_phase_to_kspace_with_shifts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.utils.nifti_affine.html">nifti_affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.utils.remove_extra_kspace_samples.html">remove_extra_kspace_samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.io.utils.siemens_quat_to_rot_mat.html">siemens_quat_to_rot_mat</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.extras.html"><code class="docutils literal notranslate"><span class="pre">mrinufft.extras</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.extras.data.html"><code class="docutils literal notranslate"><span class="pre">extras.data</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.data.get_brainweb_map.html">get_brainweb_map</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.extras.field_map.html"><code class="docutils literal notranslate"><span class="pre">extras.field_map</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.field_map.make_b0map.html">make_b0map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.field_map.make_t2smap.html">make_t2smap</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.extras.gradient.html"><code class="docutils literal notranslate"><span class="pre">extras.gradient</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.gradient.cg.html">cg</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.extras.sim.html"><code class="docutils literal notranslate"><span class="pre">extras.sim</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.sim.fse_simulation.html">fse_simulation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.extras.smaps.html"><code class="docutils literal notranslate"><span class="pre">extras.smaps</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.smaps.coil_compression.html">coil_compression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.smaps.low_frequency.html">low_frequency</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/mrinufft.extras.utils.html"><code class="docutils literal notranslate"><span class="pre">extras.utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/mrinufft.extras.utils.get_smaps.html">get_smaps</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_autosummary/mrinufft._utils.html"><code class="docutils literal notranslate"><span class="pre">mrinufft._utils</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/mrinufft._utils.auto_cast.html">auto_cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/mrinufft._utils.get_array_module.html">get_array_module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/mrinufft._utils.power_method.html">power_method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/mrinufft._utils.proper_trajectory.html">proper_trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/mrinufft._utils.MethodRegister.html">MethodRegister</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellanneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../misc/contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/development.html">Developing MRI-nufft</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Related Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://cea-cosmic.github.io/pysap">PySAP</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cea-cosmic.github.io/ModOpt/">ModOpt</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/paquiteau/brainweb-dl">Brainweb-dl</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft/edit/main/generated/autoexamples/GPU/example_fastMRI_UNet.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mind-inria/mri-nufft/issues/new?title=Issue%20on%20page%20%2Fgenerated/autoexamples/GPU/example_fastMRI_UNet.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/generated/autoexamples/GPU/example_fastMRI_UNet.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Simple UNet model.</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-generated-autoexamples-gpu-example-fastmri-unet-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="simple-unet-model">
<span id="sphx-glr-generated-autoexamples-gpu-example-fastmri-unet-py"></span><h1>Simple UNet model.<a class="headerlink" href="#simple-unet-model" title="Link to this heading">#</a></h1>
<p>This model is a simplified version of the U-Net architecture,
which is widely used for image segmentation tasks.
This is implemented in the proprietary FASTMRI package <a class="reference internal" href="#fastmri" id="id1"><span>[fastmri]</span></a>.</p>
<p>The U-Net model consists of an encoder (downsampling path) and
a decoder (upsampling path) with skip connections between corresponding
layers in the encoder and decoder.
These skip connections help in retaining spatial information
that is lost during the downsampling process.</p>
<p>The primary purpose of this model is to perform image reconstruction tasks,
specifically for MRI images.
It takes an input MRI image and reconstructs it to improve the image quality
or to recover missing parts of the image.</p>
<p>This implementation of the UNet model was pulled from the FastMRI Facebook
repository, which is a collaborative research project aimed at advancing
the field of medical imaging using machine learning techniques.</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat{x}} = \mathrm{arg} \min_{\mathbf{x}} || \mathcal{U}_\mathbf{\theta}(\mathbf{y}) - \mathbf{x} ||_2^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{x}}\)</span> is the reconstructed MRI image, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is the ground truth image,
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is the input MRI image (e.g., k-space data), and <span class="math notranslate nohighlight">\(\mathcal{U}_\mathbf{\theta}\)</span> is the U-Net model parameterized by <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We train on a single image here. In practice, this should be done on a database like fastMRI <a class="reference internal" href="#fastmri" id="id2"><span>[fastmri]</span></a>.</p>
</div>
<div class="colab-button">
            <a href="https://colab.research.google.com/github/mind-inria/mri-nufft/blob/gh-pages/examples/generated/autoexamples/GPU/example_fastMRI_UNet.ipynb" target="_blank">
                <img src="https://colab.research.google.com/assets/colab-badge.svg" 
                alt="Open In Colab"/>
            </a>
        </div>
        <p>Imports</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">brainweb_dl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bwdl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tmp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">fastmri.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Unet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mrinufft</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_operator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mrinufft.trajectories</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize_2D_cones</span>
</pre></div>
</div>
<p>Setup a simple class for the U-Net model</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BACKEND</span></a> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MRINUFFT_BACKEND&quot;</span><span class="p">,</span> <span class="s2">&quot;cufinufft&quot;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model for MRI reconstruction using a U-Net.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_trajectory</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="n">get_operator</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">BACKEND</span></a><span class="p">,</span> <span class="n">wrt_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span>
            <span class="n">initial_trajectory</span><span class="p">,</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">squeeze_dims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unet</span> <span class="o">=</span> <span class="n">Unet</span><span class="p">(</span><span class="n">in_chans</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_chans</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">chans</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_pool_layers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kspace</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward pass of the model.&quot;&quot;&quot;</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">adj_op</span><span class="p">(</span><span class="n">kspace</span><span class="p">)</span>
        <span class="n">recon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unet</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">float</span><span class="p">())</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
        <span class="n">recon</span> <span class="o">/=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recon</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">recon</span>
</pre></div>
</div>
<p>Utility function to plot the state of the model</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_state</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">,</span> <span class="n">mri_2D</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">recon</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Image plotting function.</span>

<span class="sd">    Plot the original MRI image, the trajectory, the reconstructed image,</span>
<span class="sd">    and the loss curve (if provided). Saves the plot if a filename is provided.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axs (numpy array): Array of matplotlib axes to plot on.</span>
<span class="sd">    mri_2D (torch.Tensor): Original MRI image.</span>
<span class="sd">    traj : Trajectory.</span>
<span class="sd">    recon (torch.Tensor): Reconstructed image after training.</span>
<span class="sd">    loss (list, optional): List of loss values to plot. Defaults to None.</span>
<span class="sd">    save_name (str, optional): Filename to save the plot. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">abs</span></a><span class="p">(</span><span class="n">mri_2D</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;MR Image&quot;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">traj</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trajectory&quot;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">abs</span></a><span class="p">(</span><span class="n">recon</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Reconstruction&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">loss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="p">)</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.savefig.html#matplotlib.pyplot.savefig" title="matplotlib.pyplot.savefig" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span></a><span class="p">(</span><span class="n">save_name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.close.html#matplotlib.pyplot.close" title="matplotlib.pyplot.close" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">close</span></a><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p>Setup Inputs (models, trajectory and image)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_traj</span></a> <span class="o">=</span> <span class="n">initialize_2D_cones</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float32" title="numpy.float32" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">np</span><span class="o">.</span><span class="n">float32</span></a><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_traj</span></a><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/volatile/github-ci-mind-inria/gpu_mind_runner/_work/mri-nufft/venv/lib/python3.10/site-packages/mrinufft/_utils.py:94: UserWarning: Samples will be rescaled to [-pi, pi), assuming they were in [-0.5, 0.5)
  warnings.warn(
/volatile/github-ci-mind-inria/gpu_mind_runner/_work/mri-nufft/venv/lib/python3.10/site-packages/mrinufft/_utils.py:99: UserWarning: Samples will be rescaled to [-0.5, 0.5), assuming they were in [-pi, pi)
  warnings.warn(

Model(
  (operator): MRINufftAutoGrad()
  (unet): Unet(
    (down_sample_layers): ModuleList(
      (0): ConvBlock(
        (layers): Sequential(
          (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
          (3): Dropout2d(p=0.0, inplace=False)
          (4): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (6): LeakyReLU(negative_slope=0.2, inplace=True)
          (7): Dropout2d(p=0.0, inplace=False)
        )
      )
      (1): ConvBlock(
        (layers): Sequential(
          (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
          (3): Dropout2d(p=0.0, inplace=False)
          (4): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (6): LeakyReLU(negative_slope=0.2, inplace=True)
          (7): Dropout2d(p=0.0, inplace=False)
        )
      )
      (2): ConvBlock(
        (layers): Sequential(
          (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
          (3): Dropout2d(p=0.0, inplace=False)
          (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (6): LeakyReLU(negative_slope=0.2, inplace=True)
          (7): Dropout2d(p=0.0, inplace=False)
        )
      )
      (3): ConvBlock(
        (layers): Sequential(
          (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
          (3): Dropout2d(p=0.0, inplace=False)
          (4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (6): LeakyReLU(negative_slope=0.2, inplace=True)
          (7): Dropout2d(p=0.0, inplace=False)
        )
      )
    )
    (conv): ConvBlock(
      (layers): Sequential(
        (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (2): LeakyReLU(negative_slope=0.2, inplace=True)
        (3): Dropout2d(p=0.0, inplace=False)
        (4): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (5): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (6): LeakyReLU(negative_slope=0.2, inplace=True)
        (7): Dropout2d(p=0.0, inplace=False)
      )
    )
    (up_conv): ModuleList(
      (0): ConvBlock(
        (layers): Sequential(
          (0): Conv2d(512, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
          (3): Dropout2d(p=0.0, inplace=False)
          (4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (6): LeakyReLU(negative_slope=0.2, inplace=True)
          (7): Dropout2d(p=0.0, inplace=False)
        )
      )
      (1): ConvBlock(
        (layers): Sequential(
          (0): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
          (3): Dropout2d(p=0.0, inplace=False)
          (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (6): LeakyReLU(negative_slope=0.2, inplace=True)
          (7): Dropout2d(p=0.0, inplace=False)
        )
      )
      (2): ConvBlock(
        (layers): Sequential(
          (0): Conv2d(128, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
          (3): Dropout2d(p=0.0, inplace=False)
          (4): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (6): LeakyReLU(negative_slope=0.2, inplace=True)
          (7): Dropout2d(p=0.0, inplace=False)
        )
      )
      (3): Sequential(
        (0): ConvBlock(
          (layers): Sequential(
            (0): Conv2d(64, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
            (2): LeakyReLU(negative_slope=0.2, inplace=True)
            (3): Dropout2d(p=0.0, inplace=False)
            (4): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (5): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
            (6): LeakyReLU(negative_slope=0.2, inplace=True)
            (7): Dropout2d(p=0.0, inplace=False)
          )
        )
        (1): Conv2d(32, 1, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (up_transpose_conv): ModuleList(
      (0): TransposeConvBlock(
        (layers): Sequential(
          (0): ConvTranspose2d(512, 256, kernel_size=(2, 2), stride=(2, 2), bias=False)
          (1): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
        )
      )
      (1): TransposeConvBlock(
        (layers): Sequential(
          (0): ConvTranspose2d(256, 128, kernel_size=(2, 2), stride=(2, 2), bias=False)
          (1): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
        )
      )
      (2): TransposeConvBlock(
        (layers): Sequential(
          (0): ConvTranspose2d(128, 64, kernel_size=(2, 2), stride=(2, 2), bias=False)
          (1): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
        )
      )
      (3): TransposeConvBlock(
        (layers): Sequential(
          (0): ConvTranspose2d(64, 32, kernel_size=(2, 2), stride=(2, 2), bias=False)
          (1): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
          (2): LeakyReLU(negative_slope=0.2, inplace=True)
        )
      )
    )
  )
)
</pre></div>
</div>
<p>Get the image on which we will train our U-Net Model</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mri_2D</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.flipud.html#numpy.flipud" title="numpy.flipud" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">flipud</span></a><span class="p">(</span><span class="n">bwdl</span><span class="o">.</span><span class="n">get_mri</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;T1&quot;</span><span class="p">)[</span><span class="mi">80</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.complex64" title="numpy.complex64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">np</span><span class="o">.</span><span class="n">complex64</span></a><span class="p">))[</span>
    <span class="kc">None</span>
<span class="p">]</span>
<span class="n">mri_2D</span> <span class="o">=</span> <span class="n">mri_2D</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mri_2D</span><span class="p">)</span>
<span class="n">kspace_mri_2D</span> <span class="o">=</span> <a href="../../_autosummary/mrinufft.operators.autodiff.MRINufftAutoGrad.html#mrinufft.operators.autodiff.MRINufftAutoGrad.op" title="mrinufft.operators.autodiff.MRINufftAutoGrad.op" class="sphx-glr-backref-module-mrinufft-operators-autodiff sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">op</span></a><span class="p">(</span><span class="n">mri_2D</span><span class="p">)</span>

<span class="c1"># Before training, here is the simple reconstruction we have using a</span>
<span class="c1"># density compensated adjoint.</span>
<span class="n">dc_adjoint</span> <span class="o">=</span> <a href="../../_autosummary/mrinufft.operators.autodiff.MRINufftAutoGrad.html#mrinufft.operators.autodiff.MRINufftAutoGrad.adj_op" title="mrinufft.operators.autodiff.MRINufftAutoGrad.adj_op" class="sphx-glr-backref-module-mrinufft-operators-autodiff sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">adj_op</span></a><span class="p">(</span><span class="n">kspace_mri_2D</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_state</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">,</span> <span class="n">mri_2D</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_traj</span></a><span class="p">,</span> <span class="n">dc_adjoint</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_example_fastMRI_UNet_001.png" srcset="../../../_images/sphx_glr_example_fastMRI_UNet_001.png" alt="MR Image, Trajectory, Reconstruction" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/volatile/github-ci-mind-inria/gpu_mind_runner/_work/mri-nufft/mri-nufft/examples/GPU/example_fastMRI_UNet.py:132: UserWarning: Casting complex values to real discards the imaginary part (Triggered internally at /pytorch/aten/src/ATen/native/Copy.cpp:307.)
  mri_2D = torch.Tensor(np.flipud(bwdl.get_mri(4, &quot;T1&quot;)[80, ...]).astype(np.complex64))[
/volatile/github-ci-mind-inria/gpu_mind_runner/_work/mri-nufft/mri-nufft/examples/GPU/example_fastMRI_UNet.py:105: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  axs[0].imshow(np.abs(mri_2D[0]), cmap=&quot;gray&quot;)
</pre></div>
</div>
<p>Start training loop</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">num_epochs</span></a> <span class="o">=</span> <span class="mi">100</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">RAdam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">losses</span></a> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store the loss values and create an animation</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">image_files</span></a> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store the images to create a gif</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">num_epochs</span></a><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tqdms</span><span class="p">:</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a> <span class="ow">in</span> <span class="n">tqdms</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">kspace_mri_2D</span><span class="p">)</span>  <span class="c1"># Forward pass</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">l1_loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">mri_2D</span><span class="p">[</span><span class="kc">None</span><span class="p">])</span>  <span class="c1"># Compute loss</span>
        <span class="n">tqdms</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()})</span>  <span class="c1"># Update progress bar</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">losses</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>  <span class="c1"># Store loss value</span>

        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>  <span class="c1"># Zero gradients</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>  <span class="c1"># Backward pass</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>  <span class="c1"># Update weights</span>

        <span class="c1"># Generate images for gif</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hashed</span></a> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">hash</span><span class="p">((</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">,</span> <span class="s2">&quot;learn_traj&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/time.html#time.time" title="time.time" class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"><span class="n">time</span><span class="o">.</span><span class="n">time</span></a><span class="p">()))</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><a href="https://docs.python.org/3/library/tempfile.html#tempfile.NamedTemporaryFile" title="tempfile.NamedTemporaryFile" class="sphx-glr-backref-module-tempfile sphx-glr-backref-type-py-function"><span class="n">tmp</span><span class="o">.</span><span class="n">NamedTemporaryFile</span></a><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.png&quot;</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">plot_state</span><span class="p">(</span>
            <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">,</span>
            <span class="n">mri_2D</span><span class="p">,</span>
            <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_traj</span></a><span class="p">,</span>
            <span class="n">out</span><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">losses</span></a><span class="p">,</span>
            <span class="n">save_name</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a><span class="p">,</span>
        <span class="p">)</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">image_files</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a><span class="p">)</span>


<span class="c1"># Make a GIF of all images.</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">imgs</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">image_files</span></a><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">imgs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
    <span class="s2">&quot;mrinufft_learn_unet.gif&quot;</span><span class="p">,</span>
    <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">append_images</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">imgs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
    <span class="n">optimize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># sphinx_gallery_thumbnail_path = &#39;generated/autoexamples/GPU/images/mrinufft_learn_unet.gif&#39;</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/100 [00:00&lt;?, ?steps/s]
  0%|          | 0/100 [00:00&lt;?, ?steps/s, loss=1.18]/volatile/github-ci-mind-inria/gpu_mind_runner/_work/mri-nufft/mri-nufft/examples/GPU/example_fastMRI_UNet.py:105: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
  axs[0].imshow(np.abs(mri_2D[0]), cmap=&quot;gray&quot;)

  1%|          | 1/100 [00:00&lt;01:29,  1.10steps/s, loss=1.18]
  1%|          | 1/100 [00:01&lt;01:29,  1.10steps/s, loss=1.11]
  2%|▏         | 2/100 [00:01&lt;01:26,  1.13steps/s, loss=1.11]
  2%|▏         | 2/100 [00:01&lt;01:26,  1.13steps/s, loss=1.04]
  3%|▎         | 3/100 [00:02&lt;01:24,  1.14steps/s, loss=1.04]
  3%|▎         | 3/100 [00:02&lt;01:24,  1.14steps/s, loss=0.958]
  4%|▍         | 4/100 [00:03&lt;01:23,  1.15steps/s, loss=0.958]
  4%|▍         | 4/100 [00:03&lt;01:23,  1.15steps/s, loss=0.878]
  5%|▌         | 5/100 [00:04&lt;01:21,  1.16steps/s, loss=0.878]
  5%|▌         | 5/100 [00:04&lt;01:21,  1.16steps/s, loss=0.803]
  6%|▌         | 6/100 [00:05&lt;01:28,  1.06steps/s, loss=0.803]
  6%|▌         | 6/100 [00:05&lt;01:28,  1.06steps/s, loss=0.74]
  7%|▋         | 7/100 [00:06&lt;01:24,  1.09steps/s, loss=0.74]
  7%|▋         | 7/100 [00:06&lt;01:24,  1.09steps/s, loss=0.679]
  8%|▊         | 8/100 [00:07&lt;01:22,  1.12steps/s, loss=0.679]
  8%|▊         | 8/100 [00:07&lt;01:22,  1.12steps/s, loss=0.624]
  9%|▉         | 9/100 [00:08&lt;01:20,  1.13steps/s, loss=0.624]
  9%|▉         | 9/100 [00:08&lt;01:20,  1.13steps/s, loss=0.579]
 10%|█         | 10/100 [00:08&lt;01:18,  1.14steps/s, loss=0.579]
 10%|█         | 10/100 [00:08&lt;01:18,  1.14steps/s, loss=0.541]
 11%|█         | 11/100 [00:09&lt;01:17,  1.15steps/s, loss=0.541]
 11%|█         | 11/100 [00:09&lt;01:17,  1.15steps/s, loss=0.509]
 12%|█▏        | 12/100 [00:10&lt;01:16,  1.15steps/s, loss=0.509]
 12%|█▏        | 12/100 [00:10&lt;01:16,  1.15steps/s, loss=0.485]
 13%|█▎        | 13/100 [00:11&lt;01:16,  1.13steps/s, loss=0.485]
 13%|█▎        | 13/100 [00:11&lt;01:16,  1.13steps/s, loss=0.465]
 14%|█▍        | 14/100 [00:12&lt;01:16,  1.12steps/s, loss=0.465]
 14%|█▍        | 14/100 [00:12&lt;01:16,  1.12steps/s, loss=0.449]
 15%|█▌        | 15/100 [00:13&lt;01:15,  1.12steps/s, loss=0.449]
 15%|█▌        | 15/100 [00:13&lt;01:15,  1.12steps/s, loss=0.436]
 16%|█▌        | 16/100 [00:14&lt;01:22,  1.02steps/s, loss=0.436]
 16%|█▌        | 16/100 [00:14&lt;01:22,  1.02steps/s, loss=0.424]
 17%|█▋        | 17/100 [00:15&lt;01:18,  1.06steps/s, loss=0.424]
 17%|█▋        | 17/100 [00:15&lt;01:18,  1.06steps/s, loss=0.413]
 18%|█▊        | 18/100 [00:16&lt;01:16,  1.07steps/s, loss=0.413]
 18%|█▊        | 18/100 [00:16&lt;01:16,  1.07steps/s, loss=0.401]
 19%|█▉        | 19/100 [00:17&lt;01:14,  1.09steps/s, loss=0.401]
 19%|█▉        | 19/100 [00:17&lt;01:14,  1.09steps/s, loss=0.389]
 20%|██        | 20/100 [00:18&lt;01:12,  1.11steps/s, loss=0.389]
 20%|██        | 20/100 [00:18&lt;01:12,  1.11steps/s, loss=0.375]
 21%|██        | 21/100 [00:18&lt;01:10,  1.12steps/s, loss=0.375]
 21%|██        | 21/100 [00:19&lt;01:10,  1.12steps/s, loss=0.362]
 22%|██▏       | 22/100 [00:19&lt;01:09,  1.12steps/s, loss=0.362]
 22%|██▏       | 22/100 [00:19&lt;01:09,  1.12steps/s, loss=0.347]
 23%|██▎       | 23/100 [00:20&lt;01:07,  1.14steps/s, loss=0.347]
 23%|██▎       | 23/100 [00:20&lt;01:07,  1.14steps/s, loss=0.333]
 24%|██▍       | 24/100 [00:21&lt;01:05,  1.15steps/s, loss=0.333]
 24%|██▍       | 24/100 [00:21&lt;01:05,  1.15steps/s, loss=0.318]
 25%|██▌       | 25/100 [00:22&lt;01:04,  1.16steps/s, loss=0.318]
 25%|██▌       | 25/100 [00:22&lt;01:04,  1.16steps/s, loss=0.304]
 26%|██▌       | 26/100 [00:23&lt;01:09,  1.07steps/s, loss=0.304]
 26%|██▌       | 26/100 [00:23&lt;01:09,  1.07steps/s, loss=0.291]
 27%|██▋       | 27/100 [00:24&lt;01:06,  1.10steps/s, loss=0.291]
 27%|██▋       | 27/100 [00:24&lt;01:06,  1.10steps/s, loss=0.278]
 28%|██▊       | 28/100 [00:25&lt;01:04,  1.12steps/s, loss=0.278]
 28%|██▊       | 28/100 [00:25&lt;01:04,  1.12steps/s, loss=0.266]
 29%|██▉       | 29/100 [00:25&lt;01:02,  1.13steps/s, loss=0.266]
 29%|██▉       | 29/100 [00:26&lt;01:02,  1.13steps/s, loss=0.255]
 30%|███       | 30/100 [00:26&lt;01:01,  1.14steps/s, loss=0.255]
 30%|███       | 30/100 [00:26&lt;01:01,  1.14steps/s, loss=0.245]
 31%|███       | 31/100 [00:27&lt;01:00,  1.14steps/s, loss=0.245]
 31%|███       | 31/100 [00:27&lt;01:00,  1.14steps/s, loss=0.236]
 32%|███▏      | 32/100 [00:28&lt;00:59,  1.15steps/s, loss=0.236]
 32%|███▏      | 32/100 [00:28&lt;00:59,  1.15steps/s, loss=0.226]
 33%|███▎      | 33/100 [00:29&lt;00:58,  1.15steps/s, loss=0.226]
 33%|███▎      | 33/100 [00:29&lt;00:58,  1.15steps/s, loss=0.217]
 34%|███▍      | 34/100 [00:30&lt;00:57,  1.16steps/s, loss=0.217]
 34%|███▍      | 34/100 [00:30&lt;00:57,  1.16steps/s, loss=0.209]
 35%|███▌      | 35/100 [00:31&lt;00:56,  1.15steps/s, loss=0.209]
 35%|███▌      | 35/100 [00:31&lt;00:56,  1.15steps/s, loss=0.2]
 36%|███▌      | 36/100 [00:32&lt;01:00,  1.05steps/s, loss=0.2]
 36%|███▌      | 36/100 [00:32&lt;01:00,  1.05steps/s, loss=0.193]
 37%|███▋      | 37/100 [00:33&lt;00:58,  1.08steps/s, loss=0.193]
 37%|███▋      | 37/100 [00:33&lt;00:58,  1.08steps/s, loss=0.185]
 38%|███▊      | 38/100 [00:34&lt;00:56,  1.09steps/s, loss=0.185]
 38%|███▊      | 38/100 [00:34&lt;00:56,  1.09steps/s, loss=0.178]
 39%|███▉      | 39/100 [00:34&lt;00:55,  1.10steps/s, loss=0.178]
 39%|███▉      | 39/100 [00:35&lt;00:55,  1.10steps/s, loss=0.171]
 40%|████      | 40/100 [00:35&lt;00:54,  1.11steps/s, loss=0.171]
 40%|████      | 40/100 [00:35&lt;00:54,  1.11steps/s, loss=0.165]
 41%|████      | 41/100 [00:36&lt;00:52,  1.12steps/s, loss=0.165]
 41%|████      | 41/100 [00:36&lt;00:52,  1.12steps/s, loss=0.159]
 42%|████▏     | 42/100 [00:37&lt;00:51,  1.13steps/s, loss=0.159]
 42%|████▏     | 42/100 [00:37&lt;00:51,  1.13steps/s, loss=0.154]
 43%|████▎     | 43/100 [00:38&lt;00:50,  1.13steps/s, loss=0.154]
 43%|████▎     | 43/100 [00:38&lt;00:50,  1.13steps/s, loss=0.15]
 44%|████▍     | 44/100 [00:39&lt;00:49,  1.13steps/s, loss=0.15]
 44%|████▍     | 44/100 [00:39&lt;00:49,  1.13steps/s, loss=0.144]
 45%|████▌     | 45/100 [00:40&lt;00:48,  1.13steps/s, loss=0.144]
 45%|████▌     | 45/100 [00:40&lt;00:48,  1.13steps/s, loss=0.138]
 46%|████▌     | 46/100 [00:41&lt;00:52,  1.04steps/s, loss=0.138]
 46%|████▌     | 46/100 [00:41&lt;00:52,  1.04steps/s, loss=0.133]
 47%|████▋     | 47/100 [00:42&lt;00:49,  1.06steps/s, loss=0.133]
 47%|████▋     | 47/100 [00:42&lt;00:49,  1.06steps/s, loss=0.129]
 48%|████▊     | 48/100 [00:43&lt;00:48,  1.08steps/s, loss=0.129]
 48%|████▊     | 48/100 [00:43&lt;00:48,  1.08steps/s, loss=0.126]
 49%|████▉     | 49/100 [00:44&lt;00:46,  1.10steps/s, loss=0.126]
 49%|████▉     | 49/100 [00:44&lt;00:46,  1.10steps/s, loss=0.122]
 50%|█████     | 50/100 [00:44&lt;00:45,  1.11steps/s, loss=0.122]
 50%|█████     | 50/100 [00:45&lt;00:45,  1.11steps/s, loss=0.117]
 51%|█████     | 51/100 [00:45&lt;00:44,  1.11steps/s, loss=0.117]
 51%|█████     | 51/100 [00:45&lt;00:44,  1.11steps/s, loss=0.113]
 52%|█████▏    | 52/100 [00:46&lt;00:42,  1.12steps/s, loss=0.113]
 52%|█████▏    | 52/100 [00:46&lt;00:42,  1.12steps/s, loss=0.111]
 53%|█████▎    | 53/100 [00:47&lt;00:41,  1.13steps/s, loss=0.111]
 53%|█████▎    | 53/100 [00:47&lt;00:41,  1.13steps/s, loss=0.107]
 54%|█████▍    | 54/100 [00:48&lt;00:40,  1.14steps/s, loss=0.107]
 54%|█████▍    | 54/100 [00:48&lt;00:40,  1.14steps/s, loss=0.103]
 55%|█████▌    | 55/100 [00:49&lt;00:38,  1.16steps/s, loss=0.103]
 55%|█████▌    | 55/100 [00:49&lt;00:38,  1.16steps/s, loss=0.0999]
 56%|█████▌    | 56/100 [00:50&lt;00:37,  1.17steps/s, loss=0.0999]
 56%|█████▌    | 56/100 [00:50&lt;00:37,  1.17steps/s, loss=0.0969]
 57%|█████▋    | 57/100 [00:51&lt;00:40,  1.07steps/s, loss=0.0969]
 57%|█████▋    | 57/100 [00:51&lt;00:40,  1.07steps/s, loss=0.0957]
 58%|█████▊    | 58/100 [00:52&lt;00:38,  1.10steps/s, loss=0.0957]
 58%|█████▊    | 58/100 [00:52&lt;00:38,  1.10steps/s, loss=0.0947]
 59%|█████▉    | 59/100 [00:52&lt;00:36,  1.13steps/s, loss=0.0947]
 59%|█████▉    | 59/100 [00:53&lt;00:36,  1.13steps/s, loss=0.0929]
 60%|██████    | 60/100 [00:53&lt;00:35,  1.14steps/s, loss=0.0929]
 60%|██████    | 60/100 [00:53&lt;00:35,  1.14steps/s, loss=0.09]
 61%|██████    | 61/100 [00:54&lt;00:33,  1.15steps/s, loss=0.09]
 61%|██████    | 61/100 [00:54&lt;00:33,  1.15steps/s, loss=0.0856]
 62%|██████▏   | 62/100 [00:55&lt;00:32,  1.16steps/s, loss=0.0856]
 62%|██████▏   | 62/100 [00:55&lt;00:32,  1.16steps/s, loss=0.0824]
 63%|██████▎   | 63/100 [00:56&lt;00:31,  1.16steps/s, loss=0.0824]
 63%|██████▎   | 63/100 [00:56&lt;00:31,  1.16steps/s, loss=0.0807]
 64%|██████▍   | 64/100 [00:57&lt;00:30,  1.17steps/s, loss=0.0807]
 64%|██████▍   | 64/100 [00:57&lt;00:30,  1.17steps/s, loss=0.0792]
 65%|██████▌   | 65/100 [00:58&lt;00:29,  1.17steps/s, loss=0.0792]
 65%|██████▌   | 65/100 [00:58&lt;00:29,  1.17steps/s, loss=0.0788]
 66%|██████▌   | 66/100 [00:58&lt;00:29,  1.17steps/s, loss=0.0788]
 66%|██████▌   | 66/100 [00:58&lt;00:29,  1.17steps/s, loss=0.0772]
 67%|██████▋   | 67/100 [00:59&lt;00:30,  1.07steps/s, loss=0.0772]
 67%|██████▋   | 67/100 [01:00&lt;00:30,  1.07steps/s, loss=0.0759]
 68%|██████▊   | 68/100 [01:00&lt;00:28,  1.11steps/s, loss=0.0759]
 68%|██████▊   | 68/100 [01:00&lt;00:28,  1.11steps/s, loss=0.0736]
 69%|██████▉   | 69/100 [01:01&lt;00:27,  1.13steps/s, loss=0.0736]
 69%|██████▉   | 69/100 [01:01&lt;00:27,  1.13steps/s, loss=0.0714]
 70%|███████   | 70/100 [01:02&lt;00:26,  1.15steps/s, loss=0.0714]
 70%|███████   | 70/100 [01:02&lt;00:26,  1.15steps/s, loss=0.0691]
 71%|███████   | 71/100 [01:03&lt;00:24,  1.17steps/s, loss=0.0691]
 71%|███████   | 71/100 [01:03&lt;00:24,  1.17steps/s, loss=0.0677]
 72%|███████▏  | 72/100 [01:04&lt;00:23,  1.17steps/s, loss=0.0677]
 72%|███████▏  | 72/100 [01:04&lt;00:23,  1.17steps/s, loss=0.0657]
 73%|███████▎  | 73/100 [01:04&lt;00:22,  1.18steps/s, loss=0.0657]
 73%|███████▎  | 73/100 [01:05&lt;00:22,  1.18steps/s, loss=0.0655]
 74%|███████▍  | 74/100 [01:05&lt;00:21,  1.19steps/s, loss=0.0655]
 74%|███████▍  | 74/100 [01:05&lt;00:21,  1.19steps/s, loss=0.0654]
 75%|███████▌  | 75/100 [01:06&lt;00:20,  1.20steps/s, loss=0.0654]
 75%|███████▌  | 75/100 [01:06&lt;00:20,  1.20steps/s, loss=0.0655]
 76%|███████▌  | 76/100 [01:07&lt;00:19,  1.22steps/s, loss=0.0655]
 76%|███████▌  | 76/100 [01:07&lt;00:19,  1.22steps/s, loss=0.0656]
 77%|███████▋  | 77/100 [01:08&lt;00:20,  1.12steps/s, loss=0.0656]
 77%|███████▋  | 77/100 [01:08&lt;00:20,  1.12steps/s, loss=0.0623]
 78%|███████▊  | 78/100 [01:09&lt;00:19,  1.16steps/s, loss=0.0623]
 78%|███████▊  | 78/100 [01:09&lt;00:19,  1.16steps/s, loss=0.06]
 79%|███████▉  | 79/100 [01:10&lt;00:17,  1.17steps/s, loss=0.06]
 79%|███████▉  | 79/100 [01:10&lt;00:17,  1.17steps/s, loss=0.0587]
 80%|████████  | 80/100 [01:10&lt;00:16,  1.19steps/s, loss=0.0587]
 80%|████████  | 80/100 [01:11&lt;00:16,  1.19steps/s, loss=0.057]
 81%|████████  | 81/100 [01:11&lt;00:15,  1.20steps/s, loss=0.057]
 81%|████████  | 81/100 [01:11&lt;00:15,  1.20steps/s, loss=0.0562]
 82%|████████▏ | 82/100 [01:12&lt;00:14,  1.20steps/s, loss=0.0562]
 82%|████████▏ | 82/100 [01:12&lt;00:14,  1.20steps/s, loss=0.054]
 83%|████████▎ | 83/100 [01:13&lt;00:14,  1.21steps/s, loss=0.054]
 83%|████████▎ | 83/100 [01:13&lt;00:14,  1.21steps/s, loss=0.0535]
 84%|████████▍ | 84/100 [01:14&lt;00:13,  1.21steps/s, loss=0.0535]
 84%|████████▍ | 84/100 [01:14&lt;00:13,  1.21steps/s, loss=0.0549]
 85%|████████▌ | 85/100 [01:15&lt;00:12,  1.21steps/s, loss=0.0549]
 85%|████████▌ | 85/100 [01:15&lt;00:12,  1.21steps/s, loss=0.056]
 86%|████████▌ | 86/100 [01:15&lt;00:11,  1.21steps/s, loss=0.056]
 86%|████████▌ | 86/100 [01:15&lt;00:11,  1.21steps/s, loss=0.0587]
 87%|████████▋ | 87/100 [01:16&lt;00:10,  1.22steps/s, loss=0.0587]
 87%|████████▋ | 87/100 [01:16&lt;00:10,  1.22steps/s, loss=0.0547]
 88%|████████▊ | 88/100 [01:17&lt;00:10,  1.11steps/s, loss=0.0547]
 88%|████████▊ | 88/100 [01:17&lt;00:10,  1.11steps/s, loss=0.0513]
 89%|████████▉ | 89/100 [01:18&lt;00:09,  1.14steps/s, loss=0.0513]
 89%|████████▉ | 89/100 [01:18&lt;00:09,  1.14steps/s, loss=0.0507]
 90%|█████████ | 90/100 [01:19&lt;00:08,  1.17steps/s, loss=0.0507]
 90%|█████████ | 90/100 [01:19&lt;00:08,  1.17steps/s, loss=0.0506]
 91%|█████████ | 91/100 [01:20&lt;00:07,  1.16steps/s, loss=0.0506]
 91%|█████████ | 91/100 [01:20&lt;00:07,  1.16steps/s, loss=0.0494]
 92%|█████████▏| 92/100 [01:21&lt;00:06,  1.17steps/s, loss=0.0494]
 92%|█████████▏| 92/100 [01:21&lt;00:06,  1.17steps/s, loss=0.0469]
 93%|█████████▎| 93/100 [01:21&lt;00:05,  1.18steps/s, loss=0.0469]
 93%|█████████▎| 93/100 [01:22&lt;00:05,  1.18steps/s, loss=0.0448]
 94%|█████████▍| 94/100 [01:22&lt;00:05,  1.19steps/s, loss=0.0448]
 94%|█████████▍| 94/100 [01:22&lt;00:05,  1.19steps/s, loss=0.0453]
 95%|█████████▌| 95/100 [01:23&lt;00:04,  1.20steps/s, loss=0.0453]
 95%|█████████▌| 95/100 [01:23&lt;00:04,  1.20steps/s, loss=0.0459]
 96%|█████████▌| 96/100 [01:24&lt;00:03,  1.20steps/s, loss=0.0459]
 96%|█████████▌| 96/100 [01:24&lt;00:03,  1.20steps/s, loss=0.0462]
 97%|█████████▋| 97/100 [01:25&lt;00:02,  1.20steps/s, loss=0.0462]
 97%|█████████▋| 97/100 [01:25&lt;00:02,  1.20steps/s, loss=0.0497]
 98%|█████████▊| 98/100 [01:26&lt;00:01,  1.09steps/s, loss=0.0497]
 98%|█████████▊| 98/100 [01:26&lt;00:01,  1.09steps/s, loss=0.0526]
 99%|█████████▉| 99/100 [01:27&lt;00:00,  1.13steps/s, loss=0.0526]
 99%|█████████▉| 99/100 [01:27&lt;00:00,  1.13steps/s, loss=0.0502]
100%|██████████| 100/100 [01:28&lt;00:00,  1.14steps/s, loss=0.0502]
100%|██████████| 100/100 [01:28&lt;00:00,  1.14steps/s, loss=0.0502]
</pre></div>
</div>
<img src="../../../_images/mrinufft_learn_unet.gif" srcset="../../../_images/mrinufft_learn_unet.gif" alt="example learn_samples" class = "sphx-glr-single-img"/><p>Reconstruction from partially trained U-Net model</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">new_recon</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">kspace_mri_2D</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plot_state</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">,</span> <span class="n">mri_2D</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">init_traj</span></a><span class="p">,</span> <span class="n">new_recon</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">losses</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_example_fastMRI_UNet_002.png" srcset="../../../_images/sphx_glr_example_fastMRI_UNet_002.png" alt="MR Image, Trajectory, Reconstruction, Loss" class = "sphx-glr-single-img"/><section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="fastmri" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>fastmri<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>)</span>
<p>O. Ronneberger, P. Fischer, and Thomas Brox. U-net: Convolutional networks
for biomedical image segmentation. In International Conference on Medical
image computing and computer-assisted intervention, pages 234–241.
Springer, 2015.
<a class="github reference external" href="https://github.com/facebookresearch/fastMRI/blob/main/fastmri/models/unet.py">facebookresearch/fastMRI</a></p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (1 minutes 33.833 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-autoexamples-gpu-example-fastmri-unet-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/mind-inria/mri-nufft/gh-pages?urlpath=lab/tree/examples/generated/autoexamples/GPU/example_fastMRI_UNet.ipynb"><img alt="Launch binder" src="../../../_images/binder_badge_logo.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/0e14905643cb87c8e9e0f4e01596161b/example_fastMRI_UNet.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_fastMRI_UNet.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/2d0a0579b3c02394def1ca320735769a/example_fastMRI_UNet.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_fastMRI_UNet.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/1850d87d0a3a6a59ff8bef208bf12555/example_fastMRI_UNet.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">example_fastMRI_UNet.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="example_cg.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reconstruction with conjugate gradient</p>
      </div>
    </a>
    <a class="right-next"
       href="../operators/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Operators Examples</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By MRI-NUFFT Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022, MRI-NUFFT Contributors.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>