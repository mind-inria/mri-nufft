
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "generated/autoexamples/trajectories/example_traj_projection.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_generated_autoexamples_trajectories_example_traj_projection.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_generated_autoexamples_trajectories_example_traj_projection.py:


======================
Trajectory constraints
======================

A collection of methods to make trajectories fit hardware constraints.

.. GENERATED FROM PYTHON SOURCE LINES 11-16

Hereafter we illustrate different methods to reduce the gradient
strengths and slew rates required for the trajectory to match the
hardware constraints of MRI machines. A summary table is available
below.


.. GENERATED FROM PYTHON SOURCE LINES 18-32

.. list-table:: Constraint fitting methods
   :header-rows: 1

   * -
     - Gradient strength
     - Slew rate
     - Path preserved
     - Density preserved
   * - Arc-length parameterization
     - Yes
     - No
     - Yes
     - No


.. GENERATED FROM PYTHON SOURCE LINES 32-42

.. code-block:: Python


    # Internal
    import mrinufft as mn
    from mrinufft.trajectories.utils import Acquisition, compute_gradients_and_slew_rates
    from utils import show_trajectory_full

    # External
    import numpy as np









.. GENERATED FROM PYTHON SOURCE LINES 43-46

Script options
==============
These options are used in the examples below as default values for all trajectories.

.. GENERATED FROM PYTHON SOURCE LINES 46-50

.. code-block:: Python


    # Acquisition parameters
    acq = Acquisition.default








.. GENERATED FROM PYTHON SOURCE LINES 51-58

.. code-block:: Python


    # Trajectory parameters
    Nc = 16  # Number of shots
    Ns = 3000  # Number of samples per shot
    in_out = False  # Choose between in-out or center-out trajectories
    nb_zigzags = 5  # Number of zigzags for base trajectories








.. GENERATED FROM PYTHON SOURCE LINES 59-66

.. code-block:: Python


    # Display parameters
    figure_size = 10  # Figure size for trajectory plots
    subfigure_size = 6  # Figure size for subplots
    one_shot = 2 * Nc // 3  # Highlight one shot in particular
    sample_freq = 60  # Frequency of samples to display in the trajectory plots








.. GENERATED FROM PYTHON SOURCE LINES 67-69

We will be using a cone trajectory to showcase the different methods as
it switches several times between high gradients and slew rates.

.. GENERATED FROM PYTHON SOURCE LINES 69-74

.. code-block:: Python


    original_trajectory = mn.initialize_2D_cones(
        Nc, Ns, in_out=in_out, nb_zigzags=nb_zigzags
    )








.. GENERATED FROM PYTHON SOURCE LINES 75-82

Arc-length parameterization
===========================
Arc-length parameterization is the simplest method to reduce the gradient
strength as it resamples the trajectory to have a constant distance between
samples. This is technically the lowest gradient strength achievable while
preserving the path of the trajectory, but it does not preserve the k-space
density and can lead to high slew rates as shown below.

.. GENERATED FROM PYTHON SOURCE LINES 82-89

.. code-block:: Python


    show_trajectory_full(original_trajectory, one_shot, subfigure_size, sample_freq)

    grads, slews = compute_gradients_and_slew_rates(original_trajectory, acq)
    grad_max, slew_max = np.max(grads), np.max(slews)
    print(f"Max gradient: {grad_max:.3f} T/m, Max slew rate: {slew_max:.3f} T/m/ms")




.. image-sg:: /generated/autoexamples/trajectories/images/sphx_glr_example_traj_projection_001.png
   :alt: example traj projection
   :srcset: /generated/autoexamples/trajectories/images/sphx_glr_example_traj_projection_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Max gradient: 0.002 T/m, Max slew rate: 2.416 T/m/ms




.. GENERATED FROM PYTHON SOURCE LINES 91-96

.. code-block:: Python


    from mrinufft.trajectories.projection import parameterize_by_arc_length

    projected_trajectory = parameterize_by_arc_length(original_trajectory)








.. GENERATED FROM PYTHON SOURCE LINES 97-103

.. code-block:: Python


    show_trajectory_full(projected_trajectory, one_shot, subfigure_size, sample_freq)

    grads, slews = compute_gradients_and_slew_rates(projected_trajectory, acq)
    grad_max, slew_max = np.max(grads), np.max(slews)
    print(f"Max gradient: {grad_max:.3f} T/m, Max slew rate: {slew_max:.3f} T/m/ms")



.. image-sg:: /generated/autoexamples/trajectories/images/sphx_glr_example_traj_projection_002.png
   :alt: example traj projection
   :srcset: /generated/autoexamples/trajectories/images/sphx_glr_example_traj_projection_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Max gradient: 0.001 T/m, Max slew rate: 13.185 T/m/ms





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.520 seconds)


.. _sphx_glr_download_generated_autoexamples_trajectories_example_traj_projection.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/mind-inria/mri-nufft/gh-pages?urlpath=lab/tree/examples/generated/autoexamples/trajectories/example_traj_projection.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_traj_projection.ipynb <example_traj_projection.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_traj_projection.py <example_traj_projection.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_traj_projection.zip <example_traj_projection.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
